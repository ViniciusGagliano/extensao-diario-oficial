



<html>
    <head>
        <title>Identifica��o do Usu�rio</title>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
        <meta http-equiv="Pragma"       content="no-cache">
        <link rel="stylesheet" href="../css/F6_estilos.css">

    </head>
    <script language="JavaScript" src="../../F6_FrameWork_Portal/JavaScript/browsers.js"></script>
    <script language="JavaScript" src="../JavaScript/F6_PBEFunctions.js" type="text/javascript"></script>
    <script language="javascript">

function fiMostrarConteudo()
 {
	setTimeout("Layer.style.visibility = 'hidden'",50);
	bodyconteudo.style.visibility = 'visible';
 }

 function fiCarregarConteudo()
 {
	document.writeln("
        <div id='Layer'>
            <b>
                <table width='100%' height='100%'>
                    <tr>
                        <td valign=middle align='center'>
                            <font style='font-family:Arial; font-size:10px; font-weight: 900; color:White' id='Fonte'></font>
                        </td>
                    </tr>
                </table>
            </b>
        </div>");
	document.body.style.cursor="wait";
	Layer.style.position = "Absolute";
	Layer.style.top = "0";
	Layer.style.left = "0";
	Layer.style.width = "100%";
	Layer.style.height = "120";
	Fonte.innerText = "Iniciando Estrutura do Menu Din�mico. Aguarde o Processamento...";
 }
    </script>
    <html>
        <script language="JavaScript"></script>
    </html>
    <script language="javascript">
	var i = 0;

	for(i; i < document.forms.length; i++)
	{
	
		document.forms[i].autocomplete = "off";
	
	}


    </script><script language=javascript> alert('Erro [US]: Server was unable to process request. ---> Index was outside the bounds of the array.'); </script>
<script language=javascript>
    <!--
	parent.titulo.location.replace('F6_titBasico.asp?TituloPagina=Identifica��o do Usu�rio&TituloSistema=Portal de Neg�cios');
	parent.rodape.location.replace('F6_botConfTrocarSenha.asp');
//-->

</script>
<script language=Javascript>
    <!--
function fiValidaCampos(){
	if (document.forms[0].txtUsuario.value.length == 0){
		alert("Informe o Usu�rio");
		document.forms[0].txtUsuario.focus();
		return false;
	}

	if (document.forms[0].pswSenha.value.length == 0){
		alert("Informe a Senha");
		document.forms[0].pswSenha.focus();
		return false;
	}
	return true;
}

function fiChamaConfirmar(){
	if (fiValidaCampos()){
		document.body.style.cursor="wait";

        var cdUsuario = document.forms[0].txtUsuario.value;
        preAutentica(cdUsuario);	        

	}
	return false;
}


//-->

</script>
<body bgcolor="#ffffff" leftmargin=0 topmargin=0 rightmargin=0 onLoad="document.forms[0].txtUsuario.focus();" >
    <form name=frmIdentificacaoUsuario id=frmIdentificacaoUsuario method=post autocomplete=off>
        <input type="hidden" id="txtIs_nav"   name="txtIs_nav"   value="false">
        <br>
        <input type="hidden" id="txtIs_moz"   name="txtIs_moz"   value="false">
        <br>
        <input type="hidden" id="txtIs_ie"    name="txtIs_ie"    value="true">
        <br>
        <input type="hidden" id="txtIs_fb"    name="txtIs_fb"    value="false">
        <br>
        <input type="hidden" id="txtIs_fx"    name="txtIs_fx"    value="false">
        <br>
        <input type="hidden" id="txtIs_major" name="txtIs_major" value="10">
        <br>
        <input type="hidden" id="txtIs_minor" name="txtIs_minor" value="10">
        <br>
        <input type="hidden" id="txtW_width"  name="txtW_width"  value="">
        <br>
        <input type="hidden" id="txtW_height" name="txtW_height" value="">
        <br>
        <input type="hidden" id="autoSubmit"  name="autoSubmit"  value="0">
        <br>
        <input type="hidden" id="hdnSubmit"   name="hdnSubmit"   value="1">
        <br>
        <input type="hidden" id="pswSenhaCript" name="pswSenhaCript">
        <br>
        <div id="divTituloSenha" style="position:absolute; width:482px; height:16px; z-index:1; left:119px; top:5px;FONT-SIZE: 10px;FONT-WEIGHT: bold;FONT-FAMILY: verdana;COLOR: #666666; margin-left:-241px; margin-right: -241px; margin-top: -100px; margin-bottom: -1px;">Informe o nome de acesso e senha</div>
        <div id="Layer1" style="position:absolute; width:482px; height:146px; z-index:1; margin-left:-241px; margin-right: -241px; margin-top: -73px; margin-bottom: -73px;">
            <div id="divNome" style="position:absolute; width:102px; height:40px; z-index:1; left:119px; top:5px">
                <table width="102" height="40" cellpadding="0" cellspacing="0" border="0">
                    <tr>
                        <td width="102" valign="top">
                            <img src="../imagens/dot.gif" width="102" height="9" alt="">
                        </td>
                    </tr>
                    <tr>
                        <td width="102" align="center">
                            <input name="txtUsuario" type="text" style="width:100px;" class="box" maxlength="13" onKeyPress="return onTecla(event)"  onKeyDown="return onTecla(event)" onFocus="return FieldClick(this);" >
                        </td>
                    </tr>
                    <tr>
                        <td width="102" valign="bottom">
                            <img src="../imagens/dot.gif" width="102" height="12" alt="">
                        </td>
                    </tr>
                </table>
            </div>
            <div id="divSenha" style="position:absolute; width:52px; height:40px; z-index:1; left:294px; top:5px">
                <table width="52" height="40" cellpadding="0" cellspacing="0" border="0">
                    <tr>
                        <td width="52" valign="top">
                            <img src="../imagens/dot.gif" width="52" height="9" alt="">
                        </td>
                    </tr>
                    <tr>
                        <td width="52" align="center">
                            <input name="pswSenha" type="password" id="pw" class="box" style="width:50px;" maxlength="99" onKeyPress="return onTecla(event)" onKeyDown="return onTecla(event)" onFocus="return FieldClick(this)">
                        </td>
                    </tr>
                    <tr>
                        <td width="52" valign="bottom">
                            <img src="../imagens/dot.gif" width="52" height="12" alt="">
                        </td>
                    </tr>
                </table>
            </div>
            <table width="482" border="0" cellpadding="0" cellspacing="0" align="center">
                <tr>
                    <td colspan="3" align="center">
                        <img src="../imagens/top.gif" width="480" height="5" border="0">
                    </td>
                </tr>
                <tr>
                    <td width="6" align="right">
                        <img src="../imagens/left.gif" width="5" height="40" border="0">
                    </td>
                    <td width="470" height="40">
                        <table width="100%"  border="0" cellpadding="0" cellspacing="0">
                            <tr>
                                <td class="texto" width="119">
                                    <img src="../imagens/txt_login_nomeacesso.gif" width="119" height="40" alt="">
                                </td>
                                <td width="102">
                                    <img src="../imagens/lyt_btn_apoio_nome.gif" width="102" height="40" alt="">
                                </td>
                                <td class="texto" width="73">
                                    <img src="../imagens/txt_login_senha.gif" width="73" height="40" alt="">
                                </td>
                                <td width="52">
                                    <img src="../imagens/lyt_btn_apoio_senha.gif" width="52" height="40" alt="">
                                </td>
                                <td width="19">
                                    <img src="../imagens/lyt_btn_ok_left.gif" width="19" height="40" alt="">
                                </td>
                                <td align="center">
                                    <img src="../imagens/lyt_btn_ok_up.gif" width="19" height="10" alt="">
                                    <br>
                                    <a href="javascript:onEnviar();">
                                        <img src="../imagens/okLogin.gif" alt="" width="19" height="19" align="middle" border="0">
                                    </a>
                                    <br>
                                    <img src="../imagens/lyt_btn_ok_down.gif" width="19" height="11" alt="">
                                    <br>
						
                                </td>
                                <td width="86" align="right">
                                    <img src="../imagens/lyt_login_logo.gif" alt="" width="86" height="40" border="0">
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td width="6">
                        <img src="../imagens/right.gif" width="5" height="40" border="0">
                    </td>
                </tr>
            </table>
            <img id="VirtualKeyboard" name="VirtualKeyboard" hspace="0" border="0" usemap="#teclado" src="../VirtualKeyboard/VirtualKeyboard.dll?VKS=1 VK=d118d21eb37fd01cd71bd61a5b97d519d915db17da16ac12d802914cc30fc10dc00ca24ea448b65aa14da74baa46a64aba56bc50a34f938b88649c54ca06c60ac4088f63b25ea04cb75bb559b458bb57b955b854bf5334d8ad418e629c54c20ecb07c70b8057a945ab47b05ca549b15dbd51be52cf13cd11c904cc10d31f914cc5099c54f30ea574ac7e81569253" width=482 height=100>
            <map id="teclado" name="teclado">
                <area shape="rect" coords="16,11,40,30"" onmousedown="return ShapeClick(00)">
                <area shape="rect" coords="41,11,65,30"" onmousedown="return ShapeClick(01)">
                <area shape="rect" coords="66,11,90,30"" onmousedown="return ShapeClick(02)">
                <area shape="rect" coords="91,11,115,30"" onmousedown="return ShapeClick(03)">
                <area shape="rect" coords="116,11,140,30"" onmousedown="return ShapeClick(04)">
                <area shape="rect" coords="141,11,165,30"" onmousedown="return ShapeClick(05)">
                <area shape="rect" coords="166,11,190,30"" onmousedown="return ShapeClick(06)">
                <area shape="rect" coords="191,11,215,30"" onmousedown="return ShapeClick(07)">
                <area shape="rect" coords="216,11,240,30"" onmousedown="return ShapeClick(08)">
                <area shape="rect" coords="241,11,265,30"" onmousedown="return ShapeClick(09)">
                <area shape="rect" coords="266,11,290,30"" onmousedown="return ShapeClick(10)">
                <area shape="rect" coords="291,11,315,30"" onmousedown="return ShapeClick(11)">
                <area shape="rect" coords="316,11,340,30"" onmousedown="return ShapeClick(12)">
                <area shape="rect" coords="341,11,372,30"" onmousedown="return ShapeClick(13)">
                <area shape="rect" coords="388,11,412,30"" onmousedown="return ShapeClick(14)">
                <area shape="rect" coords="413,11,437,30"" onmousedown="return ShapeClick(15)">
                <area shape="rect" coords="438,11,462,30"" onmousedown="return ShapeClick(16)">
                <area shape="rect" coords="31,31,55,50"" onmousedown="return ShapeClick(17)">
                <area shape="rect" coords="56,31,80,50"" onmousedown="return ShapeClick(18)">
                <area shape="rect" coords="81,31,105,50"" onmousedown="return ShapeClick(19)">
                <area shape="rect" coords="106,31,130,50"" onmousedown="return ShapeClick(20)">
                <area shape="rect" coords="131,31,155,50"" onmousedown="return ShapeClick(21)">
                <area shape="rect" coords="156,31,180,50"" onmousedown="return ShapeClick(22)">
                <area shape="rect" coords="181,31,205,50"" onmousedown="return ShapeClick(23)">
                <area shape="rect" coords="206,31,230,50"" onmousedown="return ShapeClick(24)">
                <area shape="rect" coords="231,31,255,50"" onmousedown="return ShapeClick(25)">
                <area shape="rect" coords="256,31,280,50"" onmousedown="return ShapeClick(26)">
                <area shape="rect" coords="281,31,305,50"" onmousedown="return ShapeClick(27)">
                <area shape="rect" coords="306,31,330,50"" onmousedown="return ShapeClick(28)">
                <area shape="rect" coords="331,31,372,50"" onmousedown="return ShapeClick(29)">
                <area shape="rect" coords="388,31,412,50"" onmousedown="return ShapeClick(30)">
                <area shape="rect" coords="413,31,437,50"" onmousedown="return ShapeClick(31)">
                <area shape="rect" coords="438,31,462,50"" onmousedown="return ShapeClick(32)">
                <area shape="rect" coords="16,51,40,70"" onmousedown="return ShapeClick(33)">
                <area shape="rect" coords="41,51,65,70"" onmousedown="return ShapeClick(34)">
                <area shape="rect" coords="66,51,90,70"" onmousedown="return ShapeClick(35)">
                <area shape="rect" coords="91,51,115,70"" onmousedown="return ShapeClick(36)">
                <area shape="rect" coords="116,51,140,70"" onmousedown="return ShapeClick(37)">
                <area shape="rect" coords="141,51,165,70"" onmousedown="return ShapeClick(38)">
                <area shape="rect" coords="166,51,190,70"" onmousedown="return ShapeClick(39)">
                <area shape="rect" coords="191,51,215,70"" onmousedown="return ShapeClick(40)">
                <area shape="rect" coords="216,51,240,70"" onmousedown="return ShapeClick(41)">
                <area shape="rect" coords="241,51,265,70"" onmousedown="return ShapeClick(42)">
                <area shape="rect" coords="266,51,290,70"" onmousedown="return ShapeClick(43)">
                <area shape="rect" coords="291,51,315,70"" onmousedown="return ShapeClick(44)">
                <area shape="rect" coords="316,51,340,70"" onmousedown="return ShapeClick(45)">
                <area shape="rect" coords="341,51,372,70"" onmousedown="return ShapeClick(46)">
                <area shape="rect" coords="388,51,412,70"" onmousedown="return ShapeClick(47)">
                <area shape="rect" coords="413,51,437,70"" onmousedown="return ShapeClick(48)">
                <area shape="rect" coords="438,51,462,70"" onmousedown="return ShapeClick(49)">
                <area shape="rect" coords="16,71,55,90"" onmousedown="return ShapeClick(50)">
                <area shape="rect" coords="56,71,80,90"" onmousedown="return ShapeClick(51)">
                <area shape="rect" coords="81,71,105,90"" onmousedown="return ShapeClick(52)">
                <area shape="rect" coords="106,71,130,90"" onmousedown="return ShapeClick(53)">
                <area shape="rect" coords="131,71,155,90"" onmousedown="return ShapeClick(54)">
                <area shape="rect" coords="156,71,180,90"" onmousedown="return ShapeClick(55)">
                <area shape="rect" coords="181,71,205,90"" onmousedown="return ShapeClick(56)">
                <area shape="rect" coords="206,71,230,90"" onmousedown="return ShapeClick(57)">
                <area shape="rect" coords="231,71,255,90"" onmousedown="return ShapeClick(58)">
                <area shape="rect" coords="256,71,280,90"" onmousedown="return ShapeClick(59)">
                <area shape="rect" coords="281,71,305,90"" onmousedown="return ShapeClick(60)">
                <area shape="rect" coords="306,71,330,90"" onmousedown="return ShapeClick(61)">
                <area shape="rect" coords="331,71,372,90"" onmousedown="return ShapeClick(62)">
                <area shape="rect" coords="388,71,412,90"" onmousedown="return ShapeClick(63)">
                <area shape="rect" coords="413,71,437,90"" onmousedown="return ShapeClick(64)">
                <area shape="rect" coords="438,71,462,90"" onmousedown="return ShapeClick(65)">

	
            </map>
        </div>
        <script language="JavaScript">
	var last;	  
	
	
	var _Letters_Array = "d118d21eb37fd01cd71bd61a5b97d519d915db17da16ac12d802914cc30fc10dc00ca24ea448b65aa14da74baa46a64aba56bc50a34f938b88649c54ca06c60ac4088f63b25ea04cb75bb559b458bb57b955b854bf5334d8ad418e629c54c20ecb07c70b8057a945ab47b05ca549b15dbd51be52cf13cd11c904cc10d31f914cc5099c54f30ea574ac7e81569253"

	
	var SelectedField="";
	var SelectedFieldOK="";
	var Shift=false;
	var acento="";
	var letra="";
	var _first = true;
	var _ctrlTyped=false;
	var one_Click = false;
	
	
	document.body.oncontextmenu = function(){return false;};
	

	
	function FieldClick(Field)
	{
		SelectedField=Field;
		if(SelectedField.name=='pswSenha')
			SelectedFieldOK='onEnviar()';
		else					
			SelectedFieldOK='functionOK()';
		return(true);
	}
	
	
	function functionOK()
	{
		MMS_ShowHide('Layer1','show');		
		//fiChamaConfirmar();		
		if (document.forms[0].txtUsuario.value.length == 0){
		    alert("Informe o Usu�rio");
		    document.forms[0].txtUsuario.focus();
		    return false;
	    }else{
	        document.frmIdentificacaoUsuario.pswSenha.focus();
	    }
		return;
	}
	
	function MMS_ShowHide(target, param){
		var obj=document;
		if(obj.layers){
			obj=obj.layers[target];
			obj.visibility=param;
		}else{
			if(obj.getElementById(target)) obj=obj.getElementById(target).style; 
			else if(obj.all[target]) obj=obj.all[target].style; 
			if(param=='show') {
				obj.visibility='visible';
			}else{ obj.visibility='hidden';}
		}
	}



	function HexStringToString(pack)
	{
		var HexStringToString_Result="";
		var HexStringToString_val;
		var iHexStringToString;

		for(iHexStringToString=0; iHexStringToString
            <pack.length; iHexStringToString+=2)
		{
			HexStringToString_val = (pack.charCodeAt(iHexStringToString)>57)?(pack.charCodeAt(iHexStringToString)-87):(pack.charCodeAt(iHexStringToString)-48);
			HexStringToString_val <<= 4;
			HexStringToString_val |= (pack.charCodeAt(iHexStringToString+1)>57)?(pack.charCodeAt(iHexStringToString+1)-87):(pack.charCodeAt(iHexStringToString+1)-48);
			HexStringToString_Result+=String.fromCharCode(HexStringToString_val);
		}

		return(HexStringToString_Result);
	}

	function onTecla(evt) 
          {
          	var theKey;
          	if ("NETSCAPE" != window.navigator.appName.toUpperCase()){
              	theKey = event.keyCode;
              }else{
              	theKey = evt.which;
              }
              
          	if (theKey == 13){
          	    if (evt.type == "keydown"){
          	        if (SelectedField.name == 'pswSenha'){
          		        onEnviar();
          		        return true;
          		    }else{
					MMS_ShowHide('Layer1','show');				
          		        document.frmIdentificacaoUsuario.pswSenha.focus();
          		        return false;
          		    }
          		}else{
          		    return false;
          		}
          	}

		
		if ( theKey == 0 || theKey == 8 || theKey == 9 || theKey == 46){
			return true;
		}else{
			return false;
		}

	}

	function ShapeClick(n)
	{			
	
	
		var reEspeciais =new RegExp("[^A-Za-z0-9]", "g");	
	
		var tempo;
		var c='';
		var i=0;
		var _Chars='';
		
		//Reposiciona o teclado na pagina randomicamente quando usuario clica em alguma tecla
		if (n != 13 && n != 29 && n != 46 && n != 50 && n != 62  && n != 63 && n != 65){ 
			PosTecladoVirtual();				
		}	
		
		MMS_ShowHide('Layer1','hide');
		tempo = setTimeout("MMS_ShowHide('Layer1','show')", 130);
		_Chars=HexStringToString(_Letters_Array);
		
		c=	String.fromCharCode(_Chars.charCodeAt(n*2)^(((((n*2)+0)%2)? 0x3f: 0xf3)))+
			String.fromCharCode(_Chars.charCodeAt((n*2)+1)^(((((n*2)+1)%2)? 0x3f: 0xf3)));
		
	
		switch (c) 
		{
			case 'ok':
				if(SelectedFieldOK!=""){
					eval(SelectedFieldOK);
					return;
				}
				break;
			case 'bs':
				SelectedField.value=SelectedField.value.substr(0, SelectedField.value.length-1);
				break;
			case 'sh':
				Shift=!Shift;
				break;
			default:

				if (SelectedField.name == 'txtUsuario' && SelectedField.value.length >= 13 && acento == ''){
					FieldClick(document.frmIdentificacaoUsuario.pswSenha);
					MMS_ShowHide('Layer1','show')
					SelectedField.focus();
					return false;
				}
					
				if(SelectedField==""){
					alert("Por favor selecione (clique) um dos campos, NOME ou SENHA");
					return false;	
				}
				if (SelectedField.name == 'pswSenha' && SelectedField.value.length >= 8){
					return false;
				}
				if(acento.length>0){
					SelectedField.value=SelectedField.value.substr(0, SelectedField.value.length-1);
					switch (acento)
					{
						case '~':
							if(c=='Aa'){
								acento='';
								c='��';
							}else if(c=='Oo'){
								acento='';
								c='��';
							}else if(c=='Nn'){
								acento='';
								c='��';
							}

							break;
						case '`':
							if(c=='Aa'){
								acento='';
								c='��';
							}else if(c=='Ee'){
								acento='';
								c='��';
							}else if(c=='Ii'){
								acento='';
								c='��';
							}else if(c=='Oo'){
								acento='';
								c='��';
							}else if(c=='Uu'){
								acento='';
								c='��';
							}
							break;
						case '^':
							if(c=='Aa'){
								acento='';
								c='��';
							}else if(c=='Ee'){
								acento='';
								c='��';
							}else if(c=='Oo'){
								acento='';
								c='��';
							}
							break;
						case '�':
							if(c=='Uu'){
								acento='';
								c='��';
							}
							break;
						case "�":
							if(c=='Aa'){
								acento='';
								c='��';
							}else if(c=='Ee'){
								acento='';
								c='��';
							}else if(c=='Ii'){
								acento='';
								c='��';
							}else if(c=='Oo'){
								acento='';
								c='��';
							}else if(c=='Uu'){
								acento='';
								c='��';
							}
							break;
					}
				}

				if(Shift){
					letra=c.charAt(0);
				}else{
					letra=c.charAt(1);
				}

				
				
				
				if(SelectedField.name == 'txtUsuario' && reEspeciais.test(letra))
				{
					acento = '';
					letra = '';
					return false;			
				}
				
				
				SelectedField.value=SelectedField.value+acento+letra.toUpperCase();

				if((acento=='') && ((letra=='~') || (letra=='`') || (letra=='^') || (letra=="�") || (letra=='�') || (letra=='"'))){
					acento=letra;
				}else{
					acento="";
				}
				
		}
		if (SelectedField.name == 'txtUsuario' && SelectedField.value.length >= 13 && acento == ''){
			FieldClick(document.frmIdentificacaoUsuario.pswSenha);
		}

	}	   
	
	function onEnviar()
	{
		if (!one_Click){
			one_Click = true;
		}else{
			return;
		}

	    MMS_ShowHide('Layer1','show');
		fiChamaConfirmar();
	
		one_Click = false;
		return;
	}
	
    //Funcao que Reposiciona o teclado na pagina randomicamente quando usuario clica em alguma tecla
	function PosTecladoVirtual()
	{
        var posLeft = 0;
        var posTop = 0;
        
        while (posLeft <= 41 || posLeft >= 51)	
        { 
            posLeft = Math.round(Math.random()*100);
        }        
        
        while (posTop <= 41 || posTop >= 51)	
        { 
            posTop = Math.round(Math.random()*100);
        }        

             
    
	    document.getElementById('Layer1').style.left= posLeft + '%';
	    document.getElementById('divTituloSenha').style.left = posLeft + '%';
    	document.getElementById('Layer1').style.top= posTop + '%';
	    document.getElementById('divTituloSenha').style.top = posTop + '%';      
    
	
	}
	
	document.getElementById('Layer1').style.left= '50%';
	document.getElementById('Layer1').style.top = '50%';
	document.getElementById('divTituloSenha').style.left= '50%';
	document.getElementById('divTituloSenha').style.top = '50%';
	



            </script>
        </form>
        <SCRIPT LANGUAGE=javascript>
            <!--

	document.getElementById("txtIs_nav").value   = is_nav;
	document.getElementById("txtIs_moz").value   = is_moz;
	document.getElementById("txtIs_ie").value    = is_ie;
	document.getElementById("txtIs_fb").value    = is_fb;
	document.getElementById("txtIs_fx").value    = is_fx;
	document.getElementById("txtIs_major").value = is_major;
	document.getElementById("txtIs_minor").value = is_minor;
	document.getElementById("autoSubmit").value	 = 0;
	//document.getElementById("txtW_width").value  =
	//document.getElementById("txtW_height").value =

	

//-->

        </SCRIPT>
    </body>
</html>